<mat-card class="plan-card">
  <mat-card-header>
    <mat-card-title>
      <div class="plan-title-row">
        <span class="plan-structure">{{ formatStatus(plan().structureType) }}</span>
      </div>
    </mat-card-title>
  </mat-card-header>
  
  <mat-card-content>
    <div class="plan-details">
      <div class="detail-item">
        <mat-icon class="detail-icon">calendar_today</mat-icon>
        <span>{{ plan().travelDays }} days</span>
      </div>
      <div class="detail-item">
        <mat-icon class="detail-icon">people</mat-icon>
        <span>{{ plan().travelers }} traveler(s)</span>
      </div>
      <div class="detail-item">
        <mat-icon class="detail-icon">event</mat-icon>
        <span>{{ plan().startDate | date: 'mediumDate' }}</span>
      </div>
    </div>

    @if (isGenerating()) {
      <div class="status-message generating">
        <mat-spinner diameter="24"></mat-spinner>
        <span>Plan is being generated...</span>
      </div>
    }

    @if (isFailed()) {
      <div class="status-message error">
        <mat-icon class="status-icon">error</mat-icon>
        <div class="status-content">
          <span class="status-title">Generation failed</span>
          @if (plan().errorMessage) {
            <span class="status-text">{{ plan().errorMessage }}</span>
          }
        </div>
      </div>
    }

    @if (isRejected()) {
      <div class="status-message rejected">
        <mat-icon class="status-icon">cancel</mat-icon>
        <span>Plan rejected</span>
      </div>
    }

    @if (isAccepted()) {
      <div class="status-message accepted">
        <mat-icon class="status-icon">check_circle</mat-icon>
        <span>Plan accepted</span>
      </div>
    }

    <div class="plan-metadata">
      <span class="metadata-text">Updated: {{ plan().lastUpdatedAt | date: 'short' }}</span>
    </div>
  </mat-card-content>

  <mat-card-actions class="plan-actions">
    @if (isGenerated()) {
      <button mat-button color="primary" (click)="onViewPlan()">
        <mat-icon>visibility</mat-icon>
        View & Decide
      </button>
    }

    @if (isFailed()) {
      <button mat-button color="primary" (click)="onRetry()">
        <mat-icon>refresh</mat-icon>
        Retry
      </button>
    }

    @if (isRejected()) {
      <button mat-button color="primary" (click)="onRetry()">
        <mat-icon>refresh</mat-icon>
        Retry
      </button>
      <button mat-button color="warn" (click)="onDelete()">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    }

    @if (isAccepted()) {
      <button mat-button color="primary" (click)="onViewPlan()">
        <mat-icon>visibility</mat-icon>
        View & Edit
      </button>
      <button mat-button color="warn" (click)="onDelete()">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    }
  </mat-card-actions>
</mat-card>
